---
title: Tutoriais de Nuvem do Azure – 2. Integrar o armazenamento do Azure
description: Conclua este curso para aprender a implementar o Armazenamento de Tabelas do Azure e o Armazenamento de Blobs do Azure em um aplicativo do HoloLens 2.
author: jessemcculloch
ms.author: jemccull
ms.date: 07/01/2020
ms.topic: article
keywords: realidade misturada, unity, tutorial, hololens, hololens 2, armazenamento do azure, serviços de nuvem do azure, Windows 10
ms.localizationpriority: high
ms.openlocfilehash: f13014757c4a3d6f9a6f3ffd53ef6aaf19334e2f
ms.sourcegitcommit: dd13a32a5bb90bd53eeeea8214cd5384d7b9ef76
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/17/2020
ms.locfileid: "94679365"
---
# <a name="2-integrating-azure-storage"></a><span data-ttu-id="67b6e-105">2. Integrar o armazenamento do Azure</span><span class="sxs-lookup"><span data-stu-id="67b6e-105">2. Integrating Azure storage</span></span>

<span data-ttu-id="67b6e-106">Neste tutorial, você aprenderá a salvar dados de entidade no armazenamento de Tabela do Azure e imagens em miniatura no Armazenamento de Blobs do Azure.</span><span class="sxs-lookup"><span data-stu-id="67b6e-106">In this tutorial, you will learn how to save entity data to Azure Table storage and thumbnail images to Azure Blob storage.</span></span> <span data-ttu-id="67b6e-107">Esse recurso nos permitirá armazenar e recuperar *Objetos Rastreados* com os dados como ID, Nome, Imagem em Miniatura etc. entre sessões e dispositivos na nuvem.</span><span class="sxs-lookup"><span data-stu-id="67b6e-107">This feature will allow us to store and retrieve *Tracked Objects* with data like ID, Name, Thumbnail Image, etc. across sessions and devices to the cloud.</span></span>

## <a name="objectives"></a><span data-ttu-id="67b6e-108">Objetivos</span><span class="sxs-lookup"><span data-stu-id="67b6e-108">Objectives</span></span>

* <span data-ttu-id="67b6e-109">Aprender os conceitos básicos sobre o armazenamento do Azure</span><span class="sxs-lookup"><span data-stu-id="67b6e-109">Learn the basics about Azure storage</span></span>
* <span data-ttu-id="67b6e-110">Saber como armazenar, modificar e recuperar dados do armazenamento de Tabelas</span><span class="sxs-lookup"><span data-stu-id="67b6e-110">Learn how to store, modify and retrieve data from Table storage</span></span>
* <span data-ttu-id="67b6e-111">Saber como armazenar e excluir imagens do armazenamento de Blobs</span><span class="sxs-lookup"><span data-stu-id="67b6e-111">Learn how to store and delete images from Blob storage</span></span>

## <a name="understanding-azure-storage"></a><span data-ttu-id="67b6e-112">Noções básicas sobre o armazenamento do Azure</span><span class="sxs-lookup"><span data-stu-id="67b6e-112">Understanding Azure storage</span></span>

<span data-ttu-id="67b6e-113">O **armazenamento do Azure** é uma solução de armazenamento da Microsoft na nuvem que pode abranger vários cenários e requisitos.</span><span class="sxs-lookup"><span data-stu-id="67b6e-113">**Azure storage** is a Microsoft storage solution on the cloud that can cover many scenarios and requirements.</span></span> <span data-ttu-id="67b6e-114">Ele é massivamente escalonável e facilmente acessível pelos desenvolvedores.</span><span class="sxs-lookup"><span data-stu-id="67b6e-114">It can scale massively and is easily approachable by developers.</span></span> <span data-ttu-id="67b6e-115">Todos os serviços podem ser consumidos no âmbito de **Conta de armazenamento do Azure**.</span><span class="sxs-lookup"><span data-stu-id="67b6e-115">All services can be consumed under the umbrella of an **Azure storage Account**.</span></span> <span data-ttu-id="67b6e-116">Para nosso caso de uso, usaremos o *Armazenamento de Tabelas* e o *Armazenamento de Blobs*.</span><span class="sxs-lookup"><span data-stu-id="67b6e-116">For our use case we will use *Table storage* and *Blob storage*.</span></span>

<span data-ttu-id="67b6e-117">Saiba mais sobre os [serviços de armazenamento do Azure](https://docs.microsoft.com/azure/storage/blobs/storage-blobs-overview).</span><span class="sxs-lookup"><span data-stu-id="67b6e-117">Learn more about [Azure storage services](https://docs.microsoft.com/azure/storage/blobs/storage-blobs-overview).</span></span>

### <a name="azure-table-storage"></a><span data-ttu-id="67b6e-118">Armazenamento de Tabela do Azure</span><span class="sxs-lookup"><span data-stu-id="67b6e-118">Azure Table storage</span></span>

<span data-ttu-id="67b6e-119">Esses serviços nos permitem armazenar dados em NoSQL; neste projeto, usaremos o serviço para armazenar informações sobre o *Objeto Rastreado* como: nome, descrição, ID de âncora espacial e muito mais.</span><span class="sxs-lookup"><span data-stu-id="67b6e-119">This services allows us to store data in a NoSQL fashion, in this project we will use it to store information about the *Tracked Object* such as: name, description, spatial anchor id, and more.</span></span>

<span data-ttu-id="67b6e-120">No contexto do aplicativo de demonstração, você precisa de duas tabelas, uma para armazenar informações sobre o projeto com informações sobre o estado dos modelos treinados – saiba mais sobre isso no tutorial ([Integrar a Visão Personalizada do Azure](mr-learning-azure-03.md)) – e uma segunda tabela para armazenar informações sobre *Objetos Rastreados*.</span><span class="sxs-lookup"><span data-stu-id="67b6e-120">In context of the demo application, you need two Tables, one to store information about the project with information about the state of trained models more about that in the ([Integrating Azure Custom Vision](mr-learning-azure-03.md)) tutorial and a second table to store information about *Tracked Objects*.</span></span>

<span data-ttu-id="67b6e-121">Saiba mais sobre [Armazenamento de Tabelas do Azure](https://docs.microsoft.com/azure/storage/tables/table-storage-overview).</span><span class="sxs-lookup"><span data-stu-id="67b6e-121">Learn more about [Azure Table storage](https://docs.microsoft.com/azure/storage/tables/table-storage-overview).</span></span>

### <a name="azure-blob-storage"></a><span data-ttu-id="67b6e-122">Armazenamento de Blobs do Azure</span><span class="sxs-lookup"><span data-stu-id="67b6e-122">Azure Blob storage</span></span>

<span data-ttu-id="67b6e-123">Esse serviço permite armazenar arquivos binários grandes; você usará isso para armazenar fotos tiradas para *Objetos Rastreados* como miniaturas.</span><span class="sxs-lookup"><span data-stu-id="67b6e-123">This service allows to store large binary files, you will use this to store photos taken for *Tracked Objects* as thumbnail.</span></span>
<span data-ttu-id="67b6e-124">Para o aplicativo de demonstração, você precisa de um Contêiner de Blob para armazenar as imagens.</span><span class="sxs-lookup"><span data-stu-id="67b6e-124">For of the demo application you need one Blob Container to store the images.</span></span>

<span data-ttu-id="67b6e-125">Saiba mais sobre [Armazenamento de Blobs do Azure](https://docs.microsoft.com/azure/storage/blobs/storage-blobs-introduction).</span><span class="sxs-lookup"><span data-stu-id="67b6e-125">Learn more about [Azure Blob storage](https://docs.microsoft.com/azure/storage/blobs/storage-blobs-introduction).</span></span>

## <a name="preparing-azure-storage"></a><span data-ttu-id="67b6e-126">Preparação do Armazenamento do Azure</span><span class="sxs-lookup"><span data-stu-id="67b6e-126">Preparing Azure Storage</span></span>

<span data-ttu-id="67b6e-127">Para consumir os serviços de armazenamento do Azure, você precisará de uma conta de armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="67b6e-127">To consume the Azure storage services you will need an Azure storage account.</span></span> <span data-ttu-id="67b6e-128">Para criar uma conta de armazenamento, consulte [Criar uma conta de armazenamento](https://docs.microsoft.com/azure/storage/common/storage-account-create?tabs=azure-portal).</span><span class="sxs-lookup"><span data-stu-id="67b6e-128">To create a storage account, see [Create a storage account](https://docs.microsoft.com/azure/storage/common/storage-account-create?tabs=azure-portal).</span></span> <span data-ttu-id="67b6e-129">Para saber mais sobre contas de armazenamento, confira [Visão geral de conta de armazenamento do Azure](https://docs.microsoft.com/azure/storage/common/storage-account-overview).</span><span class="sxs-lookup"><span data-stu-id="67b6e-129">To learn more about storage accounts, see [Azure storage account overview](https://docs.microsoft.com/azure/storage/common/storage-account-overview).</span></span>

<span data-ttu-id="67b6e-130">Quando você tiver uma conta de armazenamento, recupere a cadeia de conexão no **portal do Azure**, pois será necessária na próxima seção desta lição.</span><span class="sxs-lookup"><span data-stu-id="67b6e-130">Once you have a storage account, you can retrieve the connection string from the **Azure Portal** which will be needed in the next section of this lesson.</span></span>

### <a name="optional-azure-storage-explorer"></a><span data-ttu-id="67b6e-131">Gerenciador de Armazenamento do Azure opcional</span><span class="sxs-lookup"><span data-stu-id="67b6e-131">Optional Azure Storage Explorer</span></span>

<span data-ttu-id="67b6e-132">Embora você possa ver e verificar todas as alterações de dados na interface do usuário dentro do aplicativo, é recomendável instalar o [Gerenciador de Armazenamento do Azure](https://azure.microsoft.com/features/storage-explorer/).</span><span class="sxs-lookup"><span data-stu-id="67b6e-132">While you can see and verify all data changes from the UI inside the application, we recommend to install [Azure Storage Explorer](https://azure.microsoft.com/features/storage-explorer/).</span></span> <span data-ttu-id="67b6e-133">Essa ferramenta permite que você visualize os dados no armazenamento do Azure e é muito útil durante a depuração e o aprendizado.</span><span class="sxs-lookup"><span data-stu-id="67b6e-133">This tool allows you to visually see the data in the Azure storage and is of great help when debugging and learning.</span></span>

> [!TIP]
> <span data-ttu-id="67b6e-134">Para testar dentro do editor do Unity, você pode usar um emulador local:</span><span class="sxs-lookup"><span data-stu-id="67b6e-134">For testing from inside the Unity editor you can use a local emulator:</span></span>
> * <span data-ttu-id="67b6e-135">no Windows 10, use o [Emulador de Armazenamento do Azure](https://docs.microsoft.com/azure/storage/common/storage-use-emulator)</span><span class="sxs-lookup"><span data-stu-id="67b6e-135">on Windows 10 you can use [Azure Storage Emulator](https://docs.microsoft.com/azure/storage/common/storage-use-emulator)</span></span>
> * <span data-ttu-id="67b6e-136">no MacOS/Linux, use a [Imagem do Docker Azurite](https://hub.docker.com/_/microsoft-azure-storage-azurite) para o Docker</span><span class="sxs-lookup"><span data-stu-id="67b6e-136">on MacOS/Linux you can use [Azurite Docker Image](https://hub.docker.com/_/microsoft-azure-storage-azurite) for Docker</span></span>

## <a name="preparing-the-scene"></a><span data-ttu-id="67b6e-137">Preparando a cena</span><span class="sxs-lookup"><span data-stu-id="67b6e-137">Preparing the scene</span></span>

<span data-ttu-id="67b6e-138">Na janela Hierarquia, localize o objeto **DataManager** e selecione-o.</span><span class="sxs-lookup"><span data-stu-id="67b6e-138">In the Hierarchy window, locate the **DataManager** object and select it.</span></span>

![Unity com os campos de configuração do componente de script de DataManager mostrados no Inspetor](images/mr-learning-azure/tutorial2-section4-step1-1.png)

<span data-ttu-id="67b6e-140">Na janela Inspetor, você verá que o componente **DataManager (script)** é o local em que todas as configurações relacionadas ao **armazenamento do Azure** são mantidas.</span><span class="sxs-lookup"><span data-stu-id="67b6e-140">From the Inspector window you will see that the **DataManager (script)** component is where all **Azure storage** related settings are kept.</span></span> <span data-ttu-id="67b6e-141">Todas as configurações relevantes já estão definidas, você só precisa substituir o campo *Cadeia de Conexão*, por aquele que pode ser recuperado no portal do Azure.</span><span class="sxs-lookup"><span data-stu-id="67b6e-141">All relevant settings are already set, you just need to replace the *Connection String* field with the one you can retrieve from the Azure Portal.</span></span> <span data-ttu-id="67b6e-142">Se você estiver usando uma solução de emulador de armazenamento local do Azure, mantenha a *Cadeia de Conexão* já fornecida.</span><span class="sxs-lookup"><span data-stu-id="67b6e-142">If you are using a local Azure storage emulator solution, then you can keep the already provided *Connection String*.</span></span>

<span data-ttu-id="67b6e-143">O **DataManager (script)** é responsável por se comunicar com o **Armazenamento de tabela** e o **Armazenamento de blobs** que é consumido por outros scripts de controlador nos componentes da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="67b6e-143">The **DataManager (script)** is responsible for talking to the **Table storage** and **Blob storage** which is consumed by other controller scripts on the UI components.</span></span>

## <a name="writing-and-reading-data-from-azure-table-storage"></a><span data-ttu-id="67b6e-144">Gravando e lendo dados no armazenamento de Tabela do Azure</span><span class="sxs-lookup"><span data-stu-id="67b6e-144">Writing and reading data from Azure Table storage</span></span>

<span data-ttu-id="67b6e-145">Com tudo preparado, é hora de criar um *Objeto Rastreado*.</span><span class="sxs-lookup"><span data-stu-id="67b6e-145">With everything prepared it's time to create a *Tracked Object*.</span></span>

<span data-ttu-id="67b6e-146">Abra o aplicativo no seu HoloLens, clique em **Definir Objeto** e você verá como o objeto *EnterObjectName* se tornará ativo na hierarquia.</span><span class="sxs-lookup"><span data-stu-id="67b6e-146">Open the application on your HoloLens, click on the **Set Object** and you will see how the *EnterObjectName* object will become active in the hierarchy.</span></span> <span data-ttu-id="67b6e-147">Nesse menu, clique na *barra de pesquisa* e digite o nome que você deseja dar ao *Objeto Rastreado*.</span><span class="sxs-lookup"><span data-stu-id="67b6e-147">In this menu click on the *search bar* and type in the name you want to give the *Tracked Object*.</span></span> <span data-ttu-id="67b6e-148">Depois de fornecer um nome, clique no botão **Definir objeto**.</span><span class="sxs-lookup"><span data-stu-id="67b6e-148">After providing a name click on the **Set object** button.</span></span> <span data-ttu-id="67b6e-149">Isso criará o *Objeto Rastreado* no armazenamento de Tabela do Azure e você verá agora o **Cartão de Objeto**.</span><span class="sxs-lookup"><span data-stu-id="67b6e-149">This will create the *Tracked Object* on the Azure Table storage and you will see now the **Object Card**.</span></span>

<span data-ttu-id="67b6e-150">Este **Cartão de Objeto** é uma representação de interface do usuário do *Objeto Rastreado* e terá uma função importante várias vezes nesta série de tutoriais.</span><span class="sxs-lookup"><span data-stu-id="67b6e-150">This **Object Card** is a UI representation of the *Tracked Object* and will have an important role several times in this tutorial series.</span></span>

<span data-ttu-id="67b6e-151">Agora, clique na *caixa de texto* de descrição e digite "Car"; depois, clique no botão **Salvar** para salvar as alterações.</span><span class="sxs-lookup"><span data-stu-id="67b6e-151">Now click on the description *text box* and type in "Car", after that click on the **Save** button to save the changes.</span></span> <span data-ttu-id="67b6e-152">Interrompa o aplicativo e execute-o novamente.</span><span class="sxs-lookup"><span data-stu-id="67b6e-152">Stop the application and rerun it.</span></span>

<span data-ttu-id="67b6e-153">Agora, clique em **Pesquisar Objeto** e digite na *barra de pesquisa* o nome que você usou ao criar o *Objeto Rastreado*.</span><span class="sxs-lookup"><span data-stu-id="67b6e-153">Now this time click on **Search Object** and type in the *search bar* the name you have used before when creating the *Tracked Object*.</span></span> <span data-ttu-id="67b6e-154">Você verá que o **Cartão de Objeto** com todos os dados será recuperado do **armazenamento de Tabela do Azure**.</span><span class="sxs-lookup"><span data-stu-id="67b6e-154">You will see that the **Object Card** with all the data is retrieved from the **Azure Table storage**.</span></span>

<span data-ttu-id="67b6e-155">Sinta-se à vontade para fechar o **Cartão de Objeto** e criar novos *Objetos Rastreados* e editar seus dados.</span><span class="sxs-lookup"><span data-stu-id="67b6e-155">Feel free to close the **Object Card** and create new *Tracked Objects* and edit their data.</span></span>

> [!TIP]
> <span data-ttu-id="67b6e-156">Se você instalou o [Gerenciador de Armazenamento do Azure](https://azure.microsoft.com/features/storage-explorer/), examine a tabela de *objetos* e verá o *Objeto Rastreado* criado.</span><span class="sxs-lookup"><span data-stu-id="67b6e-156">If you have installed the [Azure Storage Explorer](https://azure.microsoft.com/features/storage-explorer/) then look into the *objects* table and you will see there the created *Tracked Object*.</span></span>

## <a name="uploading-and-download-image-from-azure-blob-storage"></a><span data-ttu-id="67b6e-157">Carregar e baixar a imagem no Armazenamento de blobs do Azure</span><span class="sxs-lookup"><span data-stu-id="67b6e-157">Uploading and Download image from Azure Blob storage</span></span>

<span data-ttu-id="67b6e-158">Nesta seção, você usará o armazenamento de blobs do Azure para carregar e baixar imagens que serão usadas como miniaturas para *Objetos Rastreados*.</span><span class="sxs-lookup"><span data-stu-id="67b6e-158">In this section you will use the Azure Blob storage to upload and download images that will be used as thumbnails for *Tracked Objects*.</span></span>

> [!NOTE]
> <span data-ttu-id="67b6e-159">Neste tutorial, o aplicativo vai tirar fotos para carregar imagens no Armazenamento de blobs.</span><span class="sxs-lookup"><span data-stu-id="67b6e-159">In this tutorial the application will take photos to upload images to the Blob storage.</span></span> <span data-ttu-id="67b6e-160">Se você estiver executando isso localmente no editor do Unity, tenha uma webcam conectada ao seu computador.</span><span class="sxs-lookup"><span data-stu-id="67b6e-160">If you are running this locally from the Unity editor, then make sure that you have a webcam connected to your computer.</span></span>

<span data-ttu-id="67b6e-161">Abra o aplicativo no seu HoloLens, clique em **Definir Objeto** e digite o nome "Car" na *barra de pesquisa*.</span><span class="sxs-lookup"><span data-stu-id="67b6e-161">Open the application on your HoloLens, click on **Set Object** and type in the *search bar* the name "Car".</span></span> <span data-ttu-id="67b6e-162">Agora você verá o **Cartão de Objeto**; clique no botão **Câmera** e será instruído a fazer um AirTap para tirar uma foto.</span><span class="sxs-lookup"><span data-stu-id="67b6e-162">Now you should see the **Object Card**, click on the **Camera** button and you will be instructed to do an AirTap to take a photo.</span></span> <span data-ttu-id="67b6e-163">Depois de tirar uma foto, você verá uma mensagem informando sobre o carregamento ativo e, depois de um tempo, a imagem aparecerá no local em que o espaço reservado estava antes.</span><span class="sxs-lookup"><span data-stu-id="67b6e-163">After taking a photo you will see a message that informs you about the active upload and after a while the image should appear where the placeholder was before.</span></span>

<span data-ttu-id="67b6e-164">Agora, execute novamente o aplicativo e pesquise o *Objeto Rastreado*; a imagem carregada anteriormente deverá aparecer como miniatura.</span><span class="sxs-lookup"><span data-stu-id="67b6e-164">Now rerun the application and search for the *Tracked Object* and the previously uploaded image should appear as thumbnail.</span></span>

## <a name="deleting-image-from-azure-blob-storage"></a><span data-ttu-id="67b6e-165">Excluir imagem do Armazenamento de blobs do Azure</span><span class="sxs-lookup"><span data-stu-id="67b6e-165">Deleting image from Azure Blob storage</span></span>

<span data-ttu-id="67b6e-166">Na seção anterior, você carregou novas imagens no Armazenamento de blobs do Azure; nesta seção, você excluirá uma miniatura de imagem dos *Objetos Rastreados*.</span><span class="sxs-lookup"><span data-stu-id="67b6e-166">In the previous section you uploaded new images to Azure Blob storage, in this section you will delete an image thumbnail for *Tracked Objects*.</span></span>

<span data-ttu-id="67b6e-167">Abra o aplicativo no seu HoloLens, clique em **Definir Objeto** e digite o nome "Car" na *barra de pesquisa*.</span><span class="sxs-lookup"><span data-stu-id="67b6e-167">Open the application on your HoloLens, click on **Set Object** and type in the *search bar* the name "Car".</span></span> <span data-ttu-id="67b6e-168">Agora verá o **Cartão de Objeto** com a imagem em miniatura; clique no botão **Excluir**.</span><span class="sxs-lookup"><span data-stu-id="67b6e-168">Now you should see the **Object Card** with the thumbnail image, click on the **Delete** button.</span></span> <span data-ttu-id="67b6e-169">Você observará que a imagem em miniatura será substituída pela imagem do espaço reservado.</span><span class="sxs-lookup"><span data-stu-id="67b6e-169">You will notice that the thumbnail image is replaced by the placeholder image.</span></span>

<span data-ttu-id="67b6e-170">Agora, execute novamente o aplicativo e pesquise o *Objeto Controlado* da miniatura excluída anteriormente. Você só verá a imagem do espaço reservado.</span><span class="sxs-lookup"><span data-stu-id="67b6e-170">Now rerun the application and search for the *Tracked Object* of the previously deleted thumbnail, you should only see the placeholder image.</span></span>

## <a name="congratulations"></a><span data-ttu-id="67b6e-171">Parabéns</span><span class="sxs-lookup"><span data-stu-id="67b6e-171">Congratulations</span></span>

<span data-ttu-id="67b6e-172">Neste tutorial, você aprendeu como os serviços de armazenamento do Azure podem ser usados para persistir dados não estruturados, como em nosso caso **Objetos Rastreados** e binários na forma de imagens em miniatura para o aplicativo de demonstração do **HoloLens 2** na nuvem.</span><span class="sxs-lookup"><span data-stu-id="67b6e-172">In this tutorial you learned how Azure storage services can be used to persist unstructured data, like in our case **Tracked Objects** and binaries in form of thumbnail images for the **HoloLens 2** demo application on the cloud.</span></span>

<span data-ttu-id="67b6e-173">No próximo tutorial, você aprenderá a usar a Visão Personalizada do Azure para detectar imagens associadas a um *Objeto Rastreado*.</span><span class="sxs-lookup"><span data-stu-id="67b6e-173">In the next tutorial you will learn how to use Azure Custom Vision to detect images associated with a *Tracked Object*.</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="67b6e-174">Próximo tutorial: 3. Integrar a Visão Personalizada do Azure</span><span class="sxs-lookup"><span data-stu-id="67b6e-174">Next tutorial: 3. Integrating Azure Custom Vision</span></span>](mr-learning-azure-03.md)
